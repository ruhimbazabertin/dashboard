<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Dashboard</title>
    <!--Integrating cdn for datatable-->
    <link rel="stylesheet" 
    type="text/css" 
    href="https://cdn.datatables.net/v/bs4/dt-1.10.25/datatables.min.css" />
  <link rel="stylesheet" 
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" 
    integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" 
    crossorigin="anonymous" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!--End of cdn-->
    <link rel="stylesheet" href="../../css/dashboard.css">
  </head>
  <body>
      <!--NAVBAR COMPONENT-->
      <nav class="navbar navbar-dark fixed-top bg-primary flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-sm-3 col-md-2 mr-0" th:href="@{/dashboard/user/index}">User Dashboard</a>
      <!-- <form th:action="@{/student/index}" method="get"> -->
         <!-- <input type="text" id="search" name="keyword" class="form-control form-control-primary w-100" placeholder="Search..." >  --> 
         <!-- </form> -->
<div class="btn-group" style="margin-right: 50px;">
  <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Admin
  </button>
  <div class="dropdown-menu">
    <a class="dropdown-item" href="#">Profile</a>
    <a class="dropdown-item" href="#">Settings</a>
    <div class="dropdown-divider"></div>
     <a class="nav-link" th:href="@{/logout}">Logout</a>
  </div>
</div>
    </nav>
    <!--SIDE MENU-->
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-2 bg-light d-none d-md-block sidebar">
                <div class="left-sidebar">
                    <ul class="nav flex-column sidebar-nav">
                        <li class="nav-item">
                          <a class="nav-link active" th:href="@{/dashboard/user/index}">
                            <svg class="bi bi-chevron-right" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>
                            Dashboard
                          </a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" th:href="@{/faculty/form}">
                            <svg class="bi bi-chevron-right" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>
                            Faculty
                          </a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" th:href="@{/department/form}">
                            <svg class="bi bi-chevron-right" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>
                            Department
                          </a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" th:href="@{/course/index}">
                            <svg class="bi bi-chevron-right" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>
                            Course
                          </a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" th:href="@{/student/index}">
                            <svg class="bi bi-chevron-right" width="16" height="16" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6.646 3.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L12.293 10 6.646 4.354a.5.5 0 010-.708z" clip-rule="evenodd"/></svg>
                            student
                          </a>
                        </li>
                      </ul>
                </div>
              </div>
        </div>
      </div>
      <!--MAIN SECTION-->
      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
        <h2>Welcome to admin dashboard</h2>
        <hr/>
      <div class="row">  <h3>Course Available</h3> <span class="" style="margin-left: 700px;"><a th:href="@{/course/form}">Add New Course</a></span></div>
<hr>
<div class="table-responsive">
    <table class="table table-bordered table-striped" id="courseTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Course Code</th>
          <th>Course Name</th>
          <th>Faculty</th>
          <th>Department</th>
          <th>Created_At</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="course: ${courses}">
          <td th:text="${course.id}"></td>
          <td th:text="${course.courseCode}"></td>
          <td th:text="${course.courseName}"></td>
         
          <td th:text="${course.faculty.name}"></td>
          <td th:text="${course.department.name}"></td>
          
          <td th:text="${course.createdAt}"></td>
          <td>
            <button type="button" class="btn btn-primary" style="color: white;" data-toggle="modal" data-target="#exampleModal"><a id="editCourseLink" th:href="@{/courses/edit/{id}(id=${course.id})}" style="text-decoration: none;"><span style="color: white;">Edit</span></a></button>
            <!--<a th:href="@{/edit/{id}(id=${course.id})}">Edit</a>-->
           <button type="button" class="btn btn-danger"> <a th:href="@{/delete/{id}(id=${course.id})}" style="text-decoration: none;"><span style="color: white;">Delete</span></a></button>
        </td>
        </tr>
        </form>
        <!--END-->

      </tbody>
    </table>
  </div>
  <!--IMPLEMENTING BOOTSTRAP MODEL HERE-->
<!-- Button trigger modal -->

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit Course</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-10">
              <form th:action="@{/courses/update}" method="put" class="needs-validation" novalidate>
                <input type="hidden" class="form-control"  id="course_id" name="id">
                  <div class="row form-group">
                      <div class="col-md-4">
                          <label for="coursecode">Course_Code</label>
                          </div>
                          <div class="col-md-6">
                              <input type="text" class="form-control"  id="course_code" name="courseCode" required>
                              <div class="invalid-feedback">
                                Please fill out this course code field.
                              </div>
                              </div>
                      </div>
                      <div class="row form-group">
                          <div class="col-md-4">
                              <label for="Coursename">Course_Name</label>
                              </div>
                              <div class="col-md-6">
                                  <input type="text" class="form-control" id="course_name" name="courseName" required>
                                  <div class="invalid-feedback">
                                    Please fill out this course name field.
                                  </div>
                                  </div>
                          </div>
                          <div class="row form-group">
                            <div class="col-md-2">
                                <label for="faculty">Select Faculty</label>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-control" name="faculty" required>
                                        <option value="">Nothing selected</option>
                                        <option th:each="faculty : ${faculties}" th:value="${faculty.id}" th:text="${faculty.name}"></option>
                                        </select>
                                        <div class="invalid-feedback">
                                          Please select Faculty.
                                        </div>
                                    </div>
                            </div>
  
                            <div class="row form-group">
                              <div class="col-md-2">
                                  <label for="firstname">Select Department</label>
                                  </div>
                                  <div class="col-md-6">
                                      <select class="form-control" name="department" required> 
                                          <option value="">Nothing selected</option>
                                           <option th:each="department: ${departments}" th:value="${department.dep_id}" th:text="${department.name}"></option>
                                          </select>
                                          <div class="invalid-feedback">
                                            Please select Department.
                                          </div>
                                      </div>
                              </div>
                          <div class="row form-group">
                              <div class="col-md-4">
                                  <label for="createdAt">Created_At</label>
                                  </div>
                                  <div class="col-md-6">
                                      <input type="date" class="form-control" id="created_at" name="createdAt" required>
                                      <div class="invalid-feedback">
                                        Please fill out this date field.
                                      </div>
                                      </div>
                              </div>
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-primary">Save changes</button>
                      </form>
      </div>

    </div>
  </div>
</div>

  <!--ENDING OF BOOTSTRAP MODEL-->
      </main>
      <!--END MAIN SECTION-->

          <!--Javascript part-->
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
          <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
      <!--CDN LINK FOR DATATABLE-->
          <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.25/datatables.min.js"></script>
          <script>
            $(document).ready(function() {
              $("#courseTable").DataTable({
                  'aoColumnDefs': [{
                      'bSortable': false,
                      'aTargets': [-1] 
                  }]
              });
            })
           </script>
                  <!--Javascript for editing  student-->
      <script>

        $('table #editCourseLink').on('click', function(event){
          event.preventDefault();
          //We need to make a request to this url:/students/edit/?id=16
          var href = $(this).attr('href');
          $.get(href, function(course, status){
            $("#course_id").val(course.id);
            $("#course_code").val(course.courseCode);
            $("#course_name").val(course.courseName);
            $("#created_at").val(course.createdAt);
          });
          $('#exampleModal').modal();
        });
      </script>
          <script>
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (function() {
              'use strict';
              window.addEventListener('load', function() {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function(form) {
                  form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                      event.preventDefault();
                      event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                  }, false);
                });
              }, false);
            })();
            </script>
      <!--END JAVASCRIPT-->
  </body>
</html>